{"version":3,"sources":["assets\\Script\\Game4Object\\PlayerCoin.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\nimport CameraManager from \"../CameraManager\";\r\nimport GameManagerCoin from \"./GameManagerCoin\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\ndeclare const firebase: any;\r\n\r\n@ccclass\r\nexport default class PlayerCoin extends cc.Component {\r\n\r\n\r\n    @property()\r\n    playerSpeed: number = 0;\r\n\r\n    private GameMgr: cc.Node = null;\r\n\r\n    private child_node: cc.Node = null;\r\n    private child_label: cc.Node = null;\r\n\r\n    private this_node_user;\r\n    //change \r\n    private current_user;\r\n    private current_user_number: number = 0;\r\n\r\n    rigidbody: cc.RigidBody = null;\r\n    private child_anim: cc.Animation = null;\r\n    //\r\n    private permited_user;\r\n\r\n    private leftDown: boolean = false;\r\n    private rightDown: boolean = false;\r\n    private upDown: boolean = false;\r\n    private downDown: boolean = false;\r\n    private premoveDirX = 0;\r\n    private moveDirX = 0;\r\n    private moveDirY = 0;\r\n    private premoveDirX_firebase = 0;\r\n    private moveDirX_firebase = 0;\r\n    private moveDirY_firebase = 0;\r\n    private logged_in_or_not = false;\r\n    moveable: boolean = true;\r\n    moveableKey: boolean = true;\r\n\r\n\r\n\r\n    onLoad() {\r\n        let handle = this;\r\n\r\n        // 每個player node都會對應一個user\r\n        let name = this.node.name;\r\n        var user = firebase.auth().currentUser.uid;\r\n        this.current_user = user;\r\n\r\n        firebase.database().ref(`player_data/${name}`).once('value', function (snapshot) {\r\n            handle.permited_user = snapshot.val().uid;\r\n            if (snapshot.val() != null) {\r\n                // console.log('fuck im innnnnnnnnnnnnnnnnnn')\r\n                handle.node.active = true;\r\n                handle.logged_in_or_not = true;\r\n            }\r\n            if (user == handle.permited_user) {\r\n                firebase.database().ref(`player_data/${name}/state_value/moveDirX`).set({ Dir: 0 })\r\n                firebase.database().ref(`player_data/${name}/state_value/moveDirY`).set({ Dir: 0 })\r\n                firebase.database().ref(`player_data/${name}/state_value/moveable`).set({ moveable: \"true\" })\r\n                firebase.database().ref(`player_data/${name}/state_value/moveableKey`).set({ moveableKey: \"true\" })\r\n                firebase.database().ref(`player_data/${name}/state_value/premoveDirX`).set({ Dir: 0 })\r\n                firebase.database().ref(`player_data/${name}/state_value/X`).set({ x: 0 })\r\n                firebase.database().ref(`player_data/${name}/state_value/Y`).set({ y: 0 })\r\n                // firebase.database().ref(`player_data/${name}/state_value/IsLogin`).set({ bool: true })\r\n            }\r\n        })\r\n        this.scheduleOnce(() => {\r\n            this.this_node_user = handle.permited_user;\r\n            console.log(\"nodeuser:\", this.node.name, this.this_node_user);\r\n            console.log(\"currentuser:\", this.current_user);\r\n            if (this.current_user == this.this_node_user) cc.find(\"Canvas/Main Camera\").getComponent(CameraManager).FollowTarget = this.node;\r\n        }, 0.5);\r\n        // 取得現在玩家編號 current_user_number\r\n        var uid = firebase.auth().currentUser.uid;\r\n        let t = this;\r\n        firebase.database().ref(`user_info/${uid}`).once('value', function (snapshot) {\r\n            if(snapshot.val() != null){\r\n                t.current_user_number = snapshot.val().player_number;\r\n                console.log(\"Game Coin current_user_number is \", t.current_user_number);\r\n            }\r\n        });\r\n    }\r\n\r\n    start() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this.rigidbody = this.node.getComponent(cc.RigidBody);\r\n\r\n        this.child_node = this.node.getChildByName(this.node.name);\r\n        this.child_label = this.node.getChildByName('Label'); // 玩家名稱\r\n        this.child_anim = this.child_node.getComponent(cc.Animation);\r\n        this.child_anim.play('Idle');\r\n        this.schedule(this.updateOthersCurrentPos, 1);\r\n        this.schedule(this.UpdateGroup, 0.5);\r\n\r\n        this.GameMgr = cc.find(\"GameManager\");\r\n    }\r\n\r\n    update(dt) {\r\n        //if the player is logged now we active the node \r\n        if (!this.logged_in_or_not) {\r\n            let handle = this;\r\n            firebase.database().ref(`player_data/${this.node.name}`).once('value', function (snaphot) {\r\n                if (snaphot.val() != null) {\r\n                    handle.node.active = true;\r\n                }\r\n            })\r\n        }\r\n\r\n        // firebase\r\n        let name = this.node.name;\r\n        let DirX = this.moveDirX_firebase;\r\n        let DirY = this.moveDirY_firebase;\r\n        let preDirX = this.premoveDirX_firebase;\r\n        let posX = this.node.position.x;\r\n        let posY = this.node.position.y;\r\n        // write firebase realtime database\r\n        if (this.current_user == this.this_node_user) {\r\n            firebase.database().ref(`player_data/${name}/state_value/moveDirX`).set({ Dir: DirX })\r\n            firebase.database().ref(`player_data/${name}/state_value/moveDirY`).set({ Dir: DirY })\r\n            firebase.database().ref(`player_data/${name}/state_value/premoveDirX`).set({ Dir: preDirX })\r\n            firebase.database().ref(`player_data/${name}/state_value/X`).set({ x: posX })\r\n            firebase.database().ref(`player_data/${name}/state_value/Y`).set({ y: posY })\r\n        }\r\n        // read firebase realtime database\r\n        DirX = 0, DirY = 0, preDirX = 0;\r\n        firebase.database().ref(`player_data/${name}/state_value`).once('value', function (snapshot) {\r\n            if (snapshot.val() != null) {\r\n                DirX = snapshot.val().moveDirX.Dir;\r\n                DirY = snapshot.val().moveDirY.Dir;\r\n                preDirX = snapshot.val().premoveDirX.Dir;\r\n            }\r\n        });\r\n        this.scheduleOnce(() => {\r\n            this.moveDirX = DirX;\r\n            this.moveDirY = DirY;\r\n            this.premoveDirX = preDirX;\r\n        }, 0.2);\r\n\r\n        // Scale\r\n        this.child_node.scaleX = (this.moveDirX >= 0) ? 1 : -1;\r\n        if (this.moveDirX == 0) this.child_node.scaleX = (this.premoveDirX >= 0) ? 1 : -1;\r\n\r\n        // Move\r\n        if (this.moveDirX == 0) {\r\n            if(this.moveable) this.rigidbody.linearVelocity = cc.v2(0, this.playerSpeed * this.moveDirY);\r\n        } else if (this.moveDirY == 0) {\r\n            if(this.moveable) this.rigidbody.linearVelocity = cc.v2(this.playerSpeed * this.moveDirX, 0);\r\n        } else {\r\n            if(this.moveable) this.rigidbody.linearVelocity = cc.v2(this.playerSpeed * this.moveDirX * 0.7, this.playerSpeed * this.moveDirY * 0.7);\r\n        }\r\n\r\n        // Animation\r\n        if ((this.moveDirX == 0 && this.moveDirY == 0) || !this.moveable) {\r\n            if (!this.child_anim.getAnimationState('Idle').isPlaying) this.child_anim.play('Idle');\r\n        } else {\r\n            if (!this.child_anim.getAnimationState('Move').isPlaying) this.child_anim.play('Move');\r\n        }\r\n    }\r\n\r\n    onKeyDown(event) {\r\n        // console.log(\"KeyDown\", event.keyCode);\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.q:\r\n                this.Killothers();\r\n                break;\r\n            case cc.macro.KEY.a:\r\n                this.leftDown = true;\r\n                this.playerMoveX(-1);\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.rightDown = true;\r\n                this.playerMoveX(1);\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                this.upDown = true;\r\n                this.playerMoveY(1);\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.downDown = true;\r\n                this.playerMoveY(-1);\r\n                break;\r\n        }\r\n    }\r\n    onKeyUp(event) {\r\n        // console.log(\"KeyDown\", event.keyCode);\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.leftDown = false;\r\n                if (this.rightDown)\r\n                    this.playerMoveX(1);\r\n                else\r\n                    this.playerMoveX(0);\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.rightDown = false;\r\n                if (this.leftDown)\r\n                    this.playerMoveX(-1);\r\n                else\r\n                    this.playerMoveX(0);\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                this.upDown = false;\r\n                if (this.downDown)\r\n                    this.playerMoveY(-1);\r\n                else\r\n                    this.playerMoveY(0);\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.downDown = false;\r\n                if (this.upDown)\r\n                    this.playerMoveY(1);\r\n                else\r\n                    this.playerMoveY(0);\r\n                break;\r\n        }\r\n    }\r\n    playerMoveX(moveDirX: number) {\r\n        if (this.current_user != this.this_node_user) return;\r\n        if (!this.moveableKey) return;\r\n        this.premoveDirX_firebase = this.moveDirX_firebase;\r\n        this.moveDirX_firebase = moveDirX;\r\n    }\r\n    playerMoveY(moveDirY: number) {\r\n        if (this.current_user != this.this_node_user) return;\r\n        if (!this.moveableKey) return;\r\n        this.moveDirY_firebase = moveDirY;\r\n    }\r\n    updateOthersCurrentPos() { // 定期自動修正其他玩家正確位置\r\n        if (this.current_user == this.this_node_user) return; // 不更新自己的node\r\n        let name = this.node.name;\r\n        // console.log(\"refresh Pos:\", name);\r\n        let posX = -1487, DirX;\r\n        let posY = -1487, DirY;\r\n        // let IsLogin: boolean;\r\n        firebase.database().ref(`player_data/${name}/state_value`).once('value', function (snapshot) {\r\n            if (snapshot.val() != null) {\r\n                posX = snapshot.val().X.x;\r\n                posY = snapshot.val().Y.y;\r\n                DirX = snapshot.val().moveDirX.Dir;\r\n                DirY = snapshot.val().moveDirY.Dir;\r\n                // IsLogin = snapshot.val().IsLogin.bool;\r\n            }\r\n        });\r\n        this.scheduleOnce(() => {\r\n            if (posX == -1487 && posY == -1487) return; // 如果firebase database沒有抓到資料，就不要更新。\r\n            let action: cc.Action;\r\n            action = cc.moveTo(0.5, posX, posY); // 修正並平滑移動到正確位置\r\n            if(Math.abs(this.node.position.x-posX)>256 || Math.abs(this.node.position.y-posY)>256){ // 如果位置差太多就直接閃現。(256為8格)\r\n                this.node.setPosition(posX,posY);\r\n            }\r\n            this.node.runAction(action);\r\n        }, 0.20);\r\n    }\r\n    UpdateGroup(){\r\n        let t = this;\r\n        firebase.database().ref(`GameCoin/${t.node.name}`).once('value', function (snapshot){\r\n            if (snapshot.val().state == \"player\"){\r\n                if(t.node.group != \"Coinplayer\"){\r\n                    console.log(\"changeGroup to player\");\r\n                    t.node.group = \"Coinplayer\";\r\n                    t.node.active = false;\r\n                    t.node.active = true;\r\n                    t.node.getChildByName(\"C\").active = false;\r\n                }\r\n            }else if (snapshot.val().state == \"thief\"){\r\n                if(t.node.group != \"Cointhief\"){\r\n                    console.log(\"changeGroup to thief\");\r\n                    t.node.group = \"Cointhief\";\r\n                    t.node.active = false;\r\n                    t.node.active = true;\r\n                    t.node.getChildByName(\"C\").active = true;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    Killothers(){\r\n        if(this.this_node_user != this.current_user) return;\r\n        // console.log(\"player\", this.current_user_number, \"want to kill !!!\");\r\n        this.GameMgr.getComponent(GameManagerCoin).BecomeThief(this.node.name);\r\n    }\r\n    onBeginContact(contact, self, other){ // 碰到偷金賊會死掉\r\n        if(other.node.group == \"Cointhief\"){\r\n            console.log(\"BeginContact on Cointhief\", other.node.name);\r\n            let current_c = this.GameMgr.getComponent(GameManagerCoin).current_coin;\r\n            this.GameMgr.getComponent(GameManagerCoin).playerDie(this.node.name);\r\n            // firebase\r\n            let str = \"player\"+this.current_user_number;\r\n            if(self.node.name == str) {\r\n                let t = this;                \r\n                firebase.database().ref(`GameCoin/${other.node.name}`).once('value', function(snaphot){\r\n                    let c = snaphot.val().coin;\r\n                    firebase.database().ref(`GameCoin/${other.node.name}`).update({ coin: c+current_c });\r\n                });                \r\n            }\r\n        }\r\n    }\r\n    // onEndContact(contact, self, other){\r\n    //     if(other.node.group == \"Cointhief\"){\r\n    //         console.log(\"EndContact on Cointhief\", other.node.name);            \r\n    //     }\r\n    // }\r\n}\r\n"]}